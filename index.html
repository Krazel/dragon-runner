<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dragon Runner ‚Äì Mapa</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    :root{ --bg:#0b0d12; --fg:#e9ecef; --accent:#4dabf7; --good:#51cf66; --warn:#fab005; --bad:#fa5252; }
    html,body{height:100%; margin:0; background:var(--bg); color:var(--fg); font-family: system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    #map{ position:absolute; inset:0; }
    .toolbar{ position:fixed; left:12px; top:12px; z-index:1000; background:#0f1219; border:1px solid rgba(255,255,255,.12); border-radius:14px; padding:10px; backdrop-filter: blur(6px); }
    .toolbar button{ padding:8px 10px; border:0; border-radius:10px; background:#141925; color:var(--fg); font-weight:600; cursor:pointer; margin-right:6px; }
    .chip{ display:inline-block; padding:6px 10px; border-radius:999px; background:#141925; border:1px solid rgba(255,255,255,.12); margin-right:6px; }
    .footer{ position:fixed; left:12px; bottom:12px; right:12px; z-index:1000; display:flex; justify-content:space-between; align-items:center; gap:8px; }
    .footer a{ color:var(--accent); text-decoration:none }
    
    /* Buscador */
    .search-panel{ position:fixed; right:12px; top:12px; z-index:1000; background:#0f1219; border:1px solid rgba(255,255,255,.12); border-radius:14px; padding:10px; backdrop-filter: blur(6px); min-width:280px; }
    .search-panel input{ width:100%; padding:8px 10px; border:1px solid rgba(255,255,255,.15); border-radius:8px; background:#141925; color:var(--fg); margin-bottom:8px; box-sizing:border-box; }
    .search-panel button{ padding:6px 12px; border:0; border-radius:8px; background:#141925; color:var(--fg); font-weight:600; cursor:pointer; margin-right:6px; margin-bottom:4px; }
    .search-panel button.accent{ background:var(--accent); color:#001828; }
    .search-results{ max-height:200px; overflow-y:auto; margin-bottom:8px; }
    .search-item{ padding:8px; background:#141925; border-radius:8px; cursor:pointer; margin-bottom:4px; font-size:12px; }
    .search-item:hover{ background:#1e2936; }
    .route-info{ background:#141925; border-radius:8px; padding:8px; margin-bottom:8px; font-size:12px; display:none; }
    .nav-buttons{ display:flex; gap:4px; flex-wrap:wrap; }
    .nav-buttons button{ flex:1; min-width:80px; }
    .route-type{ padding:4px 8px !important; border:1px solid rgba(255,255,255,.2) !important; border-radius:6px !important; font-size:10px !important; margin:0 !important; flex:1; }
    .route-type.active{ background:var(--accent) !important; color:#001828 !important; }
    
    /* Mobile responsiveness */
    @media (max-width: 768px) {
      .search-panel{ 
        right:8px; 
        top:8px; 
        left:8px; 
        min-width:unset; 
        width:auto;
        max-width:none;
      }
      .search-panel input{ font-size:16px; } /* Prevents zoom on iOS */
      .toolbar{ 
        left:8px; 
        top:auto; 
        bottom:80px; 
        right:8px;
        width:auto;
      }
      .toolbar > div:first-child{ display:none; } /* Hide "Territorio runner" title */
      .toolbar > div{ 
        display:flex; 
        flex-wrap:wrap; 
        gap:4px; 
        margin-bottom:6px;
      }
      .toolbar button, .toolbar .chip{ 
        font-size:11px; 
        padding:6px 8px; 
        flex:1; 
        min-width:60px;
        text-align:center;
      }
      .footer{ 
        left:8px; 
        bottom:8px; 
        right:8px; 
        font-size:11px;
        flex-direction:column;
        gap:4px;
      }
      .search-results{ max-height:120px; }
      .route-info{ font-size:11px; }
      .nav-buttons{ flex-direction:column; }
      .nav-buttons button{ min-width:unset; }
    }
    
    @media (max-width: 480px) {
      .search-panel{ 
        padding:8px; 
        border-radius:10px;
      }
      .toolbar{ 
        padding:8px; 
        border-radius:10px;
      }
      .toolbar button, .toolbar .chip{ 
        font-size:10px; 
        padding:5px 6px;
        min-width:50px;
      }
    }
  </style>
</head>
<body>
  <div id="map"></div>
  
  <div class="search-panel">
    <div style="margin-bottom:8px; font-weight:700; font-size:14px;">üîç Navegaci√≥n</div>
    <input id="searchInput" placeholder="Buscar destino..." autocomplete="off" />
    <div id="searchResults" class="search-results"></div>
    <div id="routeInfo" class="route-info">
      <div id="routeDistance">Distancia: --</div>
      <div id="routeBearing">Direcci√≥n: --</div>
      <div style="margin-top:8px; border-top:1px solid rgba(255,255,255,.1); padding-top:8px;">
        <div style="font-weight:600; margin-bottom:4px;">Tipo de ruta:</div>
        <div style="display:flex; gap:4px;">
          <button id="routeStraight" class="route-type">üìè Recta</button>
          <button id="routeRoad" class="route-type active">üõ£Ô∏è Calles</button>
        </div>
      </div>
    </div>
    <div class="nav-buttons">
      <button id="goTo" class="accent">Ir aqu√≠</button>
      <button id="centerMe">Mi ubicaci√≥n</button>
      <button id="clearRoute">Limpiar ruta</button>
    </div>
  </div>
  
  <div class="toolbar">
    <div style="margin-bottom:8px; font-weight:700">Territorio runner</div>
    <div style="margin-bottom:8px">
      <button id="start">Iniciar</button>
      <button id="pause">Pausar</button>
      <button id="reset">Reset tramo</button>
      <button id="clear">Borrar todo</button>
      <a href="./radar.html" class="chip">‚Üí Modo Radar</a>
    </div>
    <div>
      <span class="chip" id="status">Parado</span>
      <span class="chip" id="points">Puntos: 0</span>
      <span class="chip" id="loops">Bucles: 0</span>
      <span class="chip" id="gps">GPS: inactivo</span>
      <span class="chip" id="speed">Velocidad: 0 km/h</span>
    </div>
  </div>
  <div class="footer">
    <div>‚ö†Ô∏è Cierra un bucle volviendo cerca del punto de inicio para reclamar territorio.</div>
    <div><a href="https://www.openstreetmap.org/copyright" target="_blank">¬© OpenStreetMap</a></div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="https://unpkg.com/@turf/turf@7.2.0/turf.min.js"></script>
  <script src="./mapa.js"></script>
</body>
</html>
